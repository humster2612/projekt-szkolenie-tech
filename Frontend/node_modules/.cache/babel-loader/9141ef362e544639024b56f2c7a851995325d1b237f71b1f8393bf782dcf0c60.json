{"ast":null,"code":"import { authAPI } from \"../assets/images/api/api\";\n\n// Define action types\nconst SET_USER_DATA = 'SET_USER_DATA';\nconst LOGIN_ERROR = 'LOGIN_ERROR';\nconst REGISTER_ERROR = 'REGISTER_ERROR';\n\n// Define state type\n\n// Initial state\nconst initialState = {\n  userId: null,\n  email: null,\n  login: null,\n  isAuth: false,\n  error: null\n};\n\n// Actions\n\n// Reducer\nconst authReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case SET_USER_DATA:\n      return {\n        ...state,\n        ...action.payload,\n        isAuth: true,\n        error: null\n      };\n    case LOGIN_ERROR:\n    case REGISTER_ERROR:\n      return {\n        ...state,\n        error: action.error\n      };\n    default:\n      return state;\n  }\n};\n\n// Action creators\nexport const setAuthUserData = (userId, email, login, isAuth) => ({\n  type: SET_USER_DATA,\n  payload: {\n    userId,\n    email,\n    login,\n    isAuth\n  }\n});\nexport const login = (email, password) => async dispatch => {\n  try {\n    let response = await authAPI.login(email, password);\n    if (response && response.data) {\n      const {\n        userId\n      } = response.data;\n      dispatch(setAuthUserData(userId, email, email, true));\n    } else {\n      dispatch({\n        type: LOGIN_ERROR,\n        error: 'Ошибка: данные пользователя не получены'\n      });\n    }\n  } catch (error) {\n    var _error$response, _error$response$data;\n    dispatch({\n      type: LOGIN_ERROR,\n      error: ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'Произошла ошибка при входе пользователя'\n    });\n  }\n};\nexport const register = (username, email, password) => async dispatch => {\n  try {\n    let response = await authAPI.register(username, email, password);\n    if (response && response.data) {\n      const {\n        userId\n      } = response.data;\n      dispatch(setAuthUserData(userId, email, email, true));\n    } else {\n      dispatch({\n        type: REGISTER_ERROR,\n        error: 'Ошибка: данные пользователя не получены'\n      });\n    }\n  } catch (error) {\n    var _error$response2, _error$response2$data;\n    dispatch({\n      type: REGISTER_ERROR,\n      error: ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || 'Произошла ошибка при регистрации пользователя'\n    });\n  }\n};\nexport default authReducer;","map":{"version":3,"names":["authAPI","SET_USER_DATA","LOGIN_ERROR","REGISTER_ERROR","initialState","userId","email","login","isAuth","error","authReducer","state","action","type","payload","setAuthUserData","password","dispatch","response","data","_error$response","_error$response$data","message","register","username","_error$response2","_error$response2$data"],"sources":["/Users/victoriapolovyy/Desktop/projekt-szkolenie-tech/Frontend/src/redux/auth-reducer.ts"],"sourcesContent":["import { authAPI } from \"../assets/images/api/api\";\n\n// Define action types\nconst SET_USER_DATA = 'SET_USER_DATA';\nconst LOGIN_ERROR = 'LOGIN_ERROR';\nconst REGISTER_ERROR = 'REGISTER_ERROR';\n\n// Define state type\nexport interface AuthState {\n    userId: number | null;\n    email: string | null;\n    login: string | null;\n    isAuth: boolean;\n    error: string | null;\n}\n\n// Initial state\nconst initialState: AuthState = {\n    userId: null,\n    email: null,\n    login: null,\n    isAuth: false,\n    error: null\n};\n\n// Actions\ninterface SetAuthUserDataAction {\n    type: typeof SET_USER_DATA;\n    payload: {\n        userId: number | null;\n        email: string | null;\n        login: string | null;\n        isAuth: boolean;\n    };\n}\n\ninterface LoginErrorAction {\n    type: typeof LOGIN_ERROR;\n    error: string;\n}\n\ninterface RegisterErrorAction {\n    type: typeof REGISTER_ERROR;\n    error: string;\n}\n\ntype AuthActionTypes = SetAuthUserDataAction | LoginErrorAction | RegisterErrorAction;\n\n// Reducer\nconst authReducer = (state = initialState, action: AuthActionTypes): AuthState => {\n    switch (action.type) {\n        case SET_USER_DATA:\n            return {\n                ...state,\n                ...action.payload,\n                isAuth: true,\n                error: null\n            };\n        case LOGIN_ERROR:\n        case REGISTER_ERROR:\n            return {\n                ...state,\n                error: action.error\n            };\n        default:\n            return state;\n    }\n};\n\n// Action creators\nexport const setAuthUserData = (userId: number | null, email: string | null, login: string | null, isAuth: boolean): SetAuthUserDataAction => ({\n    type: SET_USER_DATA,\n    payload: { userId, email, login, isAuth }\n});\n\nexport const login = (email: string, password: string) => async (dispatch: any) => {\n    try {\n        let response = await authAPI.login(email, password);\n        if (response && response.data) {\n            const { userId } = response.data;\n            dispatch(setAuthUserData(userId, email, email, true));\n        } else {\n            dispatch({ type: LOGIN_ERROR, error: 'Ошибка: данные пользователя не получены' });\n        }\n    } catch (error) {\n        dispatch({ type: LOGIN_ERROR, error: error.response?.data?.message || 'Произошла ошибка при входе пользователя' });\n    }\n};\n\nexport const register = (username: string, email: string, password: string) => async (dispatch: any) => {\n    try {\n        let response = await authAPI.register(username, email, password);\n        if (response && response.data) {\n            const { userId } = response.data;\n            dispatch(setAuthUserData(userId, email, email, true));\n        } else {\n            dispatch({ type: REGISTER_ERROR, error: 'Ошибка: данные пользователя не получены' });\n        }\n    } catch (error) {\n        dispatch({ type: REGISTER_ERROR, error: error.response?.data?.message || 'Произошла ошибка при регистрации пользователя' });\n    }\n};\n\nexport default authReducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}